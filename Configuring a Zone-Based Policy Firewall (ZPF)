# Lab 01: Configuring a Zone-Based Policy Firewall (ZPF)

## ðŸŽ¯ Objective (Lab 1)
â€¢  Verify connectivity among devices before firewall configuration.
â€¢  Configure a zone-based policy (ZPF) firewall on R3.
â€¢  Verify ZPF firewall functionality using ping, SSH, and a web browser.

## ðŸ›  Steps Taken (Task 1)
1. set up the topology

2. Configured devices in accordance with presented addressing table
| Device   | Interface    | IP Address  | Subnet Mask     | Default Gateway | Switch Port |
| -------- | ------------ | ----------- | --------------- | --------------- | ----------- |
| **R1**   | G0/1         | 192.168.1.1 | 255.255.255.0   | N/A             | S1 F0/5     |
|          | S0/0/0 (DCE) | 10.1.1.1    | 255.255.255.252 | N/A             | N/A         |
| **R2**   | S0/0/0       | 10.1.1.2    | 255.255.255.252 | N/A             | N/A         |
|          | S0/0/1 (DCE) | 10.2.2.2    | 255.255.255.252 | N/A             | N/A         |
| **R3**   | G0/1         | 192.168.3.1 | 255.255.255.0   | N/A             | S3 F0/5     |
|          | S0/0/1       | 10.2.2.1    | 255.255.255.252 | N/A             | N/A         |
| **PC-A** | NIC          | 192.168.1.3 | 255.255.255.0   | 192.168.1.1     | S1 F0/6     |
| **PC-C** | NIC          | 192.168.3.3 | 255.255.255.0   | 192.168.3.1     | S3 F0/18    |

3. From PC-A, verify connectivity to PC-C and R2.
-ping 192.168.3.3
-PC> ssh -l Admin 10.2.2.2

4. From PC-C, open a web browser to the PC-A server.

## ðŸ›  Steps Taken (Task 2): Create the Firewall Zones on R3

1.  Enable the Security Technology package.
a.  On R3, issue the show version command to view the Technology Package license information.
-R3(config)# license boot module c1900 technology-package securityk9

2. Create an internal zone.
a. Use the zone security command to create a zone named IN-ZONE.
-R3(config)# zone security IN-ZONE
R3(config-sec-zone) exit

3. Create an external zone.
a. Use the zone security command to create a zone named OUT-ZONE.
-R3(config-sec-zone)# zone security OUT-ZONE
R3(config-sec-zone)# exit

## ðŸ›  Steps Taken (Task 3): Identify Traffic Using a Class-Map

1. Create an ACL that defines internal traffic.
a. Use the access-list command to create extended ACL 101 to permit all IP protocols from the 192.168.3.0/24 source network to any destination.
-R3(config)# access-list 101 permit ip 192.168.3.0 0.0.0.255 any

2. Create a class map referencing the internal traffic ACL.
a. Use the class-map type inspect command with the match-all option to create a class map named IN-NET-CLASS-MAP. Use the match access-group command to match ACL 101.
-R3(config)# class-map type inspect match-all IN-NET-CLASS-MAP
R3(config-cmap)# match access-group 101
R3(config-cmap)# exit

## ðŸ›  Steps Taken (Task 4): Specify Firewall Policies

1. Create a policy map to determine what to do with matched traffic.
a. Use the policy-map type inspect command and create a policy map named IN-2-OUT-PMAP.
-R3(config)# policy-map type inspect IN-2-OUT-PMAP

2. Specify a class type of inspect and reference class map IN-NET-CLASS-MAP.
-R3(config-pmap)# class type inspect IN-NET-CLASS-MAP

3. Specify the action of inspect for this policy map.
-R3(config-pmap-c)# inspect
-exit
-exit

## ðŸ›  Steps Taken (Task 5): Apply Firewall Policies

1. Create a pair of zones
-R3(config)# zone-pair security IN-2-OUT-ZPAIR source IN-ZONE destination OUT-ZONE

2. Specify the policy map for handling the traffic between the two zones.
a. Attach a policy-map and its associated actions to the zone pair using the service-policy type inspect command and reference the policy map previously created, IN-2-OUT-PMAP.
-R3(config-sec-zone-pair)# service-policy type inspect IN-2-OUT-PMAP
R3(config-sec-zone-pair)# exit

3. Assign interfaces to the appropriate security zones.
a. Use the zone-member security command in interface configuration mode to assign G0/1 to IN-ZONE and S0/0/1 to OUT-ZONE.
-R3(config)# interface g0/1
R3(config-if)# zone-member security IN-ZONE
R3(config-if)# exit
R3(config)# interface s0/0/1
R3(config-if)# zone-member security OUT-ZONE
R3(config-if)# exit

## ðŸ›  Steps Taken (Task 6): Test Firewall Functionality from IN-ZONE to OUT-ZONE

1. From internal PC-C, ping the external PC-A server.
From the PC-C command prompt, ping PC-A at 192.168.1.3. The ping should succeed.

2. From internal PC-C, SSH to the R2 S0/0/1 interface.
a.  From the PC-C command prompt, SSH to R2 at 10.2.2.2. Use the username Admin and the password Adminpa55 to access R2. The SSH session should succeed.
b.  While the SSH session is active, issue the command show policy-map type inspect zone-pair sessions on R3 to view established sessions.
-R3# show policy-map type inspect zone-pair sessions

3.  From PC-C, exit the SSH session on R2 and close the command prompt window.

4. From internal PC-C, open a web browser to the PC-A server web page.
a. Enter the server IP address 192.168.1.3 in the browser URL field, and click Go. The HTTP session should succeed. While the HTTP session is active, issue the command show policy-map type inspect zone-pair sessions on R3 to view established sessions.
-R3# show policy-map type inspect zone-pair sessions

5. From the PC-A server command prompt, ping PC-C.
From the PC-A command prompt, ping PC-C at 192.168.3.3. The ping should fail.

6. From R2, ping PC-C.
From R2, ping PC-C at 192.168.3.3. The ping should fail.

## ðŸ“¸ Screenshots
Screenshots(64,65,66,67)
